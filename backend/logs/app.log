from openai import OpenAI

client = OpenAI(api_key=openai_api_key)
response = client.chat.completions.create(
    model="gpt-3.5-turbo",
    messages=[
        {"role": "system", "content": "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„åŸå¸‚é‹å‹•åˆ†æå¸«ï¼Œè«‹æ ¹æ“šç”¨æˆ¶çš„é‹å‹•é¡å‹ã€åœ°é»ã€å¤©æ°£å’Œæ™‚é–“æä¾›å°ˆæ¥­çš„åˆ†æå’Œå»ºè­°ã€‚"},
        {"role": "user", "content": f"""
        è«‹åˆ†æä»¥ä¸‹é‹å‹•æƒ…æ³ï¼š
        1. é‹å‹•é¡å‹ï¼š{get_sport_name(sport)}
        2. åœ°é»ï¼š{location}
        3. å¤©æ°£ï¼š{weather}
        4. æ™‚é–“ï¼š{time}

        è«‹æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
        1. é©åˆçš„é‹å‹•è·¯ç·šå»ºè­°
        2. å¤©æ°£ç›¸é—œæ³¨æ„äº‹é …
        3. å®‰å…¨å»ºè­°
        4. é‹å‹•å¼·åº¦å»ºè­°
        5. è£å‚™å»ºè­°
        """}
    ]
)
ai_response = response.choices[0].message.content
2025-05-12 21:47:20,311 INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5001
2025-05-12 21:47:20,311 INFO [33mPress CTRL+C to quit[0m
2025-05-12 21:47:23,935 INFO 127.0.0.1 - - [12/May/2025 21:47:23] "GET /api/health HTTP/1.1" 200 -
2025-05-12 21:47:24,196 INFO 127.0.0.1 - - [12/May/2025 21:47:24] "GET /api/health HTTP/1.1" 200 -
2025-05-12 21:47:26,384 INFO 127.0.0.1 - - [12/May/2025 21:47:26] "OPTIONS /api/analyze/city HTTP/1.1" 200 -
2025-05-12 21:47:26,695 INFO æ”¶åˆ° /api/analyze/city è«‹æ±‚
2025-05-12 21:47:26,695 INFO æ”¶åˆ°è³‡æ–™: {'sport': 'running', 'location': 'å°åŒ—å¸‚', 'weather': 'æ™´å¤©', 'time': 'æ—©æ™¨'}
2025-05-12 21:47:26,695 INFO å‘¼å« OpenAI API...
2025-05-12 21:47:33,963 INFO HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-12 21:47:33,994 INFO OpenAI å›æ‡‰: ChatCompletion(id='chatcmpl-BWNn6C5AtL6cQTp5QZHEFZ2kyu8yn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='æ ¹æ“šæ‚¨çš„é‹å‹•æƒ…æ³ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å°ˆæ¥­åˆ†æå’Œå»ºè­°ï¼š\n\n1. é©åˆçš„é‹å‹•è·¯ç·šå»ºè­°ï¼š\n   è·‘æ­¥æ˜¯ä¸€ç¨®æ¥µå…·é©æ‡‰æ€§çš„é‹å‹•ï¼Œæ‚¨å¯ä»¥è€ƒæ…®åœ¨å°åŒ—å¸‚çš„å¤§å®‰æ£®æ—å…¬åœ’ã€ä¸­æ­£ç´€å¿µå ‚å‘¨é‚Šæˆ–æ²³å ¤ç­‰å¹³å¦å¯¬æ•çš„åœ°æ–¹è·‘æ­¥ã€‚é€™äº›åœ°æ–¹ç’°å¢ƒå„ªç¾ï¼Œé©åˆé€²è¡Œè·‘æ­¥é‹å‹•ã€‚\n\n2. å¤©æ°£ç›¸é—œæ³¨æ„äº‹é …ï¼š\n   åœ¨æ™´å¤©è·‘æ­¥æ™‚ï¼Œè«‹å‹™å¿…åšå¥½é˜²æ›¬æªæ–½ï¼Œæ“¦ä¸Šé˜²æ›¬éœœä»¥ä¿è­·çš®è†šå…å—ç´«å¤–ç·šå‚·å®³ã€‚å¦å¤–ï¼Œè«‹æ³¨æ„ä¿æŒèº«é«”æ°´åˆ†è£œå……ï¼Œé¿å…ä¸­æš‘ã€‚\n\n3. å®‰å…¨å»ºè­°ï¼š\n   åœ¨é‹å‹•æ™‚è«‹æ³¨æ„äººè»Šåˆ†é“ï¼Œé¸æ“‡è¡Œäººå°ˆç”¨æˆ–äººè»Šåˆ†éš”çš„è·¯ç·šï¼Œä¿æŒè­¦è¦ºä»¥é¿å…æ„å¤–ç™¼ç”Ÿã€‚å»ºè­°é¸æ“‡ç†±é–€é‹å‹•å ´æ‰€æˆ–æœ‰ç›£è¦–å™¨çš„åœ°é»é‹å‹•ï¼Œä»¥æé«˜å®‰å…¨æ€§ã€‚\n\n4. é‹å‹•å¼·åº¦å»ºè­°ï¼š\n   æ—©æ™¨æ˜¯ä¸€å€‹é©åˆé‹å‹•çš„æ™‚é–“ï¼Œç©ºæ°£æ¸…æ–°ï¼Œé©åˆé€²è¡Œè¼•è‡³ä¸­ç­‰å¼·åº¦çš„è·‘æ­¥ã€‚æ‚¨å¯ä»¥æ ¹æ“šè‡ªèº«æƒ…æ³é¸æ“‡é‹å‹•å¼·åº¦ï¼Œä¿æŒèˆ’é©çš„é‹å‹•ç¯€å¥ï¼Œä¸è¦éåº¦è² è·ã€‚\n\n5. è£å‚™å»ºè­°ï¼š\n   è·‘æ­¥æ™‚è«‹ç©¿è‘—åˆé©çš„é‹å‹•æœè£å’Œé‹å‹•é‹ï¼Œä»¥ç¢ºä¿é‹å‹•èˆ’é©ä¸¦æ¸›å°‘å—å‚·é¢¨éšªã€‚å¦å¤–ï¼Œå»ºè­°æ”œå¸¶é‹å‹•æ‰‹æ©Ÿã€èº«ä»½è­‰ã€é‘°åŒ™ã€é£²ç”¨æ°´ç­‰å¿…è¦ç‰©å“ï¼Œä»¥æ‡‰å°çªç™¼æƒ…æ³ã€‚\n\nå¸Œæœ›ä»¥ä¸Šå»ºè­°èƒ½å¹«åŠ©æ‚¨åœ¨å°åŒ—å¸‚æ™´å¤©æ—©æ™¨é€²è¡Œè·‘æ­¥é‹å‹•æ™‚æœ‰ä¸€å€‹æ„‰å¿«è€Œå®‰å…¨çš„é«”é©—ã€‚ç¥æ‚¨é‹å‹•é †åˆ©ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•å…¶ä»–å•é¡Œæˆ–éœ€è¦é€²ä¸€æ­¥çš„å”åŠ©ï¼Œè«‹éš¨æ™‚å‘Šè¨´æˆ‘ã€‚', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1747057648, model='gpt-3.5-turbo-0125', object='chat.completion', service_tier='default', system_fingerprint=None, usage=CompletionUsage(completion_tokens=688, prompt_tokens=229, total_tokens=917, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))
2025-05-12 21:47:33,996 INFO åˆ†ææˆåŠŸï¼Œå›å‚³çµæœ
2025-05-12 21:47:33,998 INFO 127.0.0.1 - - [12/May/2025 21:47:33] "POST /api/analyze/city HTTP/1.1" 200 -
2025-05-12 21:47:49,330 INFO 127.0.0.1 - - [12/May/2025 21:47:49] "OPTIONS /api/analyze/city HTTP/1.1" 200 -
2025-05-12 21:47:49,640 INFO æ”¶åˆ° /api/analyze/city è«‹æ±‚
2025-05-12 21:47:49,641 INFO æ”¶åˆ°è³‡æ–™: {'sport': 'running', 'location': 'å°åŒ—å¸‚', 'weather': 'æ™´å¤©', 'time': 'æ—©æ™¨'}
2025-05-12 21:47:49,641 INFO å‘¼å« OpenAI API...
2025-05-12 21:47:54,265 INFO HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-12 21:47:54,276 INFO OpenAI å›æ‡‰: ChatCompletion(id='chatcmpl-BWNnSC1b1NlmysoJCBPLofpTCdoMq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='æ ¹æ“šæ‚¨çš„æä¾›çš„é‹å‹•æƒ…æ³ï¼Œæˆ‘ç‚ºæ‚¨æä¾›ä»¥ä¸‹å°ˆæ¥­åˆ†æå’Œå»ºè­°ï¼š\n\n1. é©åˆçš„é‹å‹•è·¯ç·šå»ºè­°ï¼š\n   åœ¨å°åŒ—å¸‚é‹å‹•è·‘æ­¥çš„å¥½åœ°æ–¹åŒ…æ‹¬å¤§ç›´æ²³æ¿±å…¬åœ’ã€ä¸­æ­£ç´€å¿µå ‚å¤–åœã€é™½æ˜å±±ç­‰ï¼Œé€™äº›åœ°æ–¹æœ‰é©åˆæ…¢è·‘å’Œæ™¯è‰²å„ªç¾çš„è·¯ç·šï¼Œä¹Ÿæœ‰è‰¯å¥½çš„äººè»Šåˆ†æµã€‚\n\n2. å¤©æ°£ç›¸é—œæ³¨æ„äº‹é …ï¼š\n   åœ¨æ™´å¤©è·‘æ­¥æ™‚ï¼Œè«‹æ³¨æ„é©æ™‚è£œå……æ°´åˆ†ï¼Œé¿å…ä¸­æš‘å’Œè„«æ°´ã€‚å»ºè­°é¸æ“‡é¿å…é«˜æº«æ™‚æ®µé‹å‹•ï¼Œé¸æ“‡æ—©æ™¨æˆ–å‚æ™šï¼Œä»¥å…æ›æ›¬éåº¦ã€‚\n\n3. å®‰å…¨å»ºè­°ï¼š\n   åœ¨é‹å‹•æ™‚ï¼Œè«‹æ³¨æ„å‘¨åœçš„ç’°å¢ƒå®‰å…¨ï¼Œé¸æ“‡äººæµè¼ƒå¤šæˆ–æœ‰ç›£è¦–å™¨çš„åœ°æ–¹é‹å‹•ã€‚å»ºè­°å°‡æ‰‹æ©Ÿæ”œå¸¶åœ¨èº«ä¸Šä»¥ä¾¿ç·Šæ€¥è¯ç¹«ã€‚\n\n4. é‹å‹•å¼·åº¦å»ºè­°ï¼š\n   ä»¥æ—©æ™¨æ™‚é–“è·‘æ­¥ï¼Œå¯ä»¥é¸æ“‡é€²è¡Œè¼•åº¦è‡³ä¸­åº¦æœ‰æ°§é‹å‹•ï¼Œæ§åˆ¶å¿ƒç‡åœ¨60%-70%ä¹‹é–“ï¼Œä¿æŒè¼•åº¦å‡ºæ±—ç‹€æ…‹ï¼Œæœ‰åˆ©æ–¼èº«é«”å¥åº·ã€‚\n\n5. è£å‚™å»ºè­°ï¼š\n   å»ºè­°ç©¿è‘—é€æ°£ã€å¸æ±—çš„é‹å‹•æœè£ï¼Œé¸æ“‡é‹å‹•é‹å…·å‚™è‰¯å¥½çš„ç·©éœ‡å’Œæ”¯æ’åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œå¯ä»¥æºå¸¶ä¸€å€‹é‹å‹•æ‰‹ç’°ç›£æ¸¬é‹å‹•æ•¸æ“šã€‚\n\nå¸Œæœ›ä»¥ä¸Šå»ºè­°èƒ½å¤ å¹«åŠ©æ‚¨åœ¨å°åŒ—å¸‚çš„æ—©æ™¨æ™´å¤©ä¸­äº«å—é‹å‹•çš„å¿«æ¨‚å’Œå¥åº·ï¼', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1747057670, model='gpt-3.5-turbo-0125', object='chat.completion', service_tier='default', system_fingerprint=None, usage=CompletionUsage(completion_tokens=566, prompt_tokens=229, total_tokens=795, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))
2025-05-12 21:47:54,276 INFO åˆ†ææˆåŠŸï¼Œå›å‚³çµæœ
2025-05-12 21:47:54,278 INFO 127.0.0.1 - - [12/May/2025 21:47:54] "POST /api/analyze/city HTTP/1.1" 200 -
